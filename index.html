return (
                <div className="w-full bg-slate-100 min-h-screen">
                    {/* Editor Panel - Hidden in client mode */}
                    {!isClientMode && (
                        <div className="bg-white shadow-lg border-b border-slate-200 print:hidden">
                            <div className="max-w-7xl mx-auto p-8">
                                <div className="flex items-center justify-between mb-8">
                                    <div>
                                        <h1 className="text-3xl font-light text-slate-800 tracking-tight">Professional Proposal Builder</h1>
                                        {currentProposalName && (
                                            <div className="text-sm text-slate-500 mt-1">
                                                Current: <span className="font-medium">{currentProposalName}</span> 
                                                <span className="ml-2 text-green-600">● Auto-saving</span>
                                            </div>
                                        )}
                                    </div>
                                    <div className="flex space-x-3">
                                        <button onClick={handleSaveClick} className="bg-green-600 text-white px-6 py-3 hover:bg-green-700 transition-colors font-medium tracking-wide uppercase text-sm shadow-lg">
                                            Save
                                        </button>
                                        <button onClick={() => setShowLoadDialog(true)} className="bg-blue-600 text-white px-6 py-3 hover:bg-blue-700 transition-colors font-medium tracking-wide uppercase text-sm shadow-lg">
                                            Load
                                        </button>
                                        <button onClick={exportClientHTML} className="bg-orange-600 text-white px-6 py-3 hover:bg-orange-700 transition-colors font-medium tracking-wide uppercase text-sm shadow-lg">
                                            Export for Client
                                        </button>
                                        <button onClick={() => window.open(window.location.href + '?client=true', '_blank')} className="bg-purple-600 text-white px-6 py-3 hover:bg-purple-700 transition-colors font-medium tracking-wide uppercase text-sm shadow-lg">
                                            Client View
                                        </button>
                                        <button onClick={() => window.print()} className="bg-slate-800 text-white px-6 py-3 hover:bg-slate-900 transition-colors font-medium tracking-wide uppercase text-sm shadow-lg">
                                            Generate PDF
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="grid lg:grid-cols-3 gap-8">
                                    {/* Image Uploads */}
                                    <div className="lg:col-span-1">
                                        <h3 className="text-xl font-medium text-slate-800 mb-6 tracking-tight">Visual Assets</h3>
                                        {['logo', 'shakerRender', 'euroRender', 'shakerVanity', 'euroVanity', 'floorPlan'].map((type) => (
                                            <div key={type} className="mb-6">
                                                <label className="block text-sm font-medium text-slate-700 mb-3 uppercase tracking-wide">
                                                    {type.replace(/([A-Z])/g, ' $1').replace(/^./, (str) => str.toUpperCase())}
                                                </label>
                                                <input type="file" accept="image/*" onChange={(e) => handleImageUpload(type, e)} className="w-full p-3 border border-slate-300 bg-white text-slate-700" />
                                            </div>
                                        ))}
                                    </div>

                                    {/* Content Editor */}
                                    <div className="lg:col-span-2 space-y-6">
                                        <h3 className="text-xl font-medium text-slate-800 mb-6 tracking-tight">Content Management</h3>
                                        {/* Add editors for content here */}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Load Dialog */}
                    {showLoadDialog && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 print:hidden">
                            <div className="bg-white p-8 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-light text-slate-800">Saved Proposals</h2>
                                    <button onClick={() => setShowLoadDialog(false)} className="text-slate-400 hover:text-slate-600 text-2xl">×</button>
                                </div>
                                
                                {savedProposals.length === 0 ? (
                                    <p className="text-slate-500 text-center py-8">No saved proposals found.</p>
                                ) : (
                                    <div className="space-y-3">
                                        {savedProposals.map((proposal) => (
                                            <div key={proposal.name} className="flex items-center justify-between p-4 border border-slate-200 rounded hover:bg-slate-50">
                                                <div>
                                                    <div className="font-medium text-slate-800">{proposal.name}</div>
                                                    <div className="text-sm text-slate-500">
                                                        Saved: {new Date(proposal.savedAt).toLocaleString()}
                                                    </div>
                                                </div>
                                                <div className="flex space-x-2">
                                                    <button 
                                                        onClick={() => {
                                                            loadProposal(proposal.name);
                                                            setShowLoadDialog(false);
                                                        }}
                                                        className="bg-blue-600 text-white px-4 py-2 text-sm hover:bg-blue-700 transition-colors rounded"
                                                    >
                                                        Load
                                                    </button>
                                                    <button 
                                                        onClick={() => deleteProposal(proposal.name)}
                                                        className="bg-red-600 text-white px-4 py-2 text-sm hover:bg-red-700 transition-colors rounded"
                                                    >
                                                        Delete
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Client Mode Header */}
                    {isClientMode && (
                        <div className="bg-white shadow-sm border-b border-slate-200 print:hidden">
                            <div className="max-w-4xl mx-auto p-4 text-center">
                                <button onClick={() => window.print()} className="bg-slate-800 text-white px-8 py-3 hover:bg-slate-900 transition-colors font-medium tracking-wide uppercase text-sm shadow-lg">
                                    Download PDF
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Proposal Pages Preview */}
                    <div className="proposal-container max-w-none mx-auto bg-white">
                        {/* Page 1 */}
                        <div className="proposal-page w-full max-w-4xl mx-auto bg-white shadow-xl mb-8" style={{minHeight: '800px'}}>
                            <div className="bg-gradient-to-r from-slate-800 to-slate-700 p-8 relative">
                                <div className="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-amber-400 to-transparent"></div>
                                <div className="flex justify-between items-start">
                                    <div className="flex items-center space-x-6">
                                        {images.logo ? (
                                            <img src={images.logo} alt="Company Logo" className="max-w-40 max-h-16 object-contain filter brightness-0 invert" />
                                        ) : (
                                            <div className="w-40 h-16 bg-white bg-opacity-20 border border-white border-opacity-30 flex items-center justify-center rounded text-white text-xs">LOGO</div>
                                        )}
                                        <div className="h-12 w-px bg-white bg-opacity-30"></div>
                                        <div className="text-white">
                                            <div className="text-2xl font-light tracking-wide">FOUNDRY</div>
                                            <div className="text-lg font-light tracking-widest text-slate-300">CABINETCO.</div>
                                        </div>
                                    </div>
                                    <div className="text-right text-white text-sm">
                                        <div className="font-medium tracking-wide">PROJECT {content.projectNumber}</div>
                                        <div className="text-slate-300">{content.date}</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="flex-1 flex flex-col justify-center items-center text-center px-16 py-12">
                                <div className="max-w-4xl">
                                    <div className="mb-8">
                                        <div className="text-sm font-medium text-slate-600 uppercase tracking-widest mb-4">CUSTOM CABINETRY PROPOSAL</div>
                                        <h1 className="text-4xl font-light text-slate-800 mb-6 leading-tight tracking-tight">
                                            {content.title.split('–')[0]}<br/>
                                            <span className="text-2xl text-slate-600">{content.title.split('–')[1] || ''}</span>
                                        </h1>
                                        <div className="w-24 h-px bg-gradient-to-r from-transparent via-amber-400 to-transparent mx-auto"></div>
                                    </div>
                                    
                                    <div className="bg-slate-50 p-8 border-l-4 border-slate-800 text-left shadow-lg">
                                        <div className="grid md:grid-cols-2 gap-8 mb-6">
                                            <div className="text-center">
                                                <div className="text-3xl font-light text-slate-800 mb-2">{content.totalInvestment}</div>
                                                <div className="text-sm text-slate-600 uppercase tracking-wide">Investment</div>
                                            </div>
                                            <div className="text-center">
                                                <div className="text-3xl font-light text-slate-800 mb-2">{content.warrantyYears}</div>
                                                <div className="text-sm text-slate-600 uppercase tracking-wide">Year Warranty</div>
                                            </div>
                                        </div>
                                        
                                        <p className="text-base leading-relaxed text-slate-700 mb-4">{content.executiveSummary}</p>
                                        <p className="text-sm text-slate-600">{content.warrantyText}</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="bg-slate-800 p-4 mt-auto">
                                <div className="flex items-center justify-center">
                                    <div className="text-slate-300 text-sm tracking-widest">{content.tagline}</div>
                                </div>
                            </div>
                        </div>

                        {/* Page 2 */}
                        <div className="proposal-page w-full max-w-4xl mx-auto bg-white shadow-xl mb-8" style={{minHeight: '800px'}}>
                            <div className="border-b border-slate-200 pb-6 mb-8 px-8 pt-8">
                                <div className="flex justify-between items-center">
                                    <h2 className="text-2xl font-light text-slate-800 tracking-tight">Design Options & Layout</h2>
                                    <div className="text-sm text-slate-500">PROJECT {content.projectNumber} | PAGE 02</div>
                                </div>
                            </div>
                            
                            <div className="px-8 flex-1">
                                {/* Page 2 content would go here */}
                            </div>
                        </div>

                        {/* Page 3 */}
                        <div className="proposal-page w-full max-w-4xl mx-auto bg-white shadow-xl mb-8" style={{minHeight: '800px'}}>
                            <div className="border-b border-slate-200 pb-6 mb-8 px-8 pt-8">
                                <div className="flex justify-between items-center">
                                    <h2 className="text-2xl font-light text-slate-800 tracking-tight">Timeline & Next Steps</h2>
                                    <div className="text-sm text-slate-500">PROJECT {content.projectNumber} | PAGE 03</div>
                                </div>
                            </div>
                            
                            <div className="px-8 flex-1 flex flex-col">
                                {/* Page 3 content would go here */}
                            </div>
                        </div>
                    </div>
                </div>
            );<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Foundry Cabinet Co. – Proposal Builder</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    @media print {
      * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
      .print\:hidden { display: none !important; }
      .proposal-page { width: 8.5in !important; height: 11in !important; margin: 0 !important; page-break-after: always !important; overflow: hidden !important; }
      @page { size: 8.5in 11in; margin: 0.25in; }
      .proposal-container, body { background: white !important; }
      body { font-size: 12px !important; }
    }
    .proposal-page { display: flex; flex-direction: column; min-height: 800px; box-sizing: border-box; }
    .content-section { overflow-wrap: break-word; word-wrap: break-word; }
  </style>
</head>
<body class="bg-slate-100">
  <div class="max-w-4xl mx-auto p-6">
    <h1 class="text-3xl font-light text-slate-800 mb-6">Proposal Builder</h1>
    <div class="space-y-4">
      <input id="clientName" type="text" placeholder="Client Name" class="border p-2 w-full"/>
      <input id="projectNumber" type="text" placeholder="Project Number" class="border p-2 w-full"/>
      <textarea id="executiveSummary" placeholder="Executive Summary" class="border p-2 w-full h-32"></textarea>
      <input id="totalInvestment" type="text" placeholder="Total Investment" class="border p-2 w-full"/>
      <div class="flex flex-wrap gap-2">
        <button onclick="saveProposal()" class="bg-green-600 text-white px-4 py-2">💾 Save</button>
        <button onclick="loadProposals()" class="bg-blue-600 text-white px-4 py-2">📂 Load</button>
        <button onclick="exportClient()" class="bg-orange-600 text-white px-4 py-2">📤 Export</button>
        <button onclick="window.print()" class="bg-slate-800 text-white px-4 py-2">🖨 PDF</button>
      </div>
    </div>
    <div id="preview" class="proposal-page bg-white shadow mt-8 p-6">
      <h2 class="text-2xl font-light text-slate-800 mb-4">Preview</h2>
      <p id="previewContent" class="text-slate-700">Nothing yet. Fill in fields and click Save.</p>
    </div>
    <div id="loadDialog" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
      <div class="bg-white p-6 rounded-lg shadow max-w-lg w-full">
        <h2 class="text-xl font-light mb-4">Saved Proposals</h2>
        <div id="proposalList" class="space-y-2"></div>
        <button onclick="closeDialog()" class="mt-4 bg-slate-600 text-white px-4 py-2">Close</button>
      </div>
    </div>
  </div>

  <script>
    const SUPABASE_URL = "https://nqzyoegnquyqfngmaktn.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5xenlvZWducXV5cWZuZ21ha3RuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NTkzNzYsImV4cCI6MjA3NDQzNTM3Nn0.lcQ8VW3zSdvyoZkJbhnT3CeyeYbxswEiAhZnAjo5Lac";
    const db = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function saveProposal() {
      const proposal = {
        clientName: document.getElementById('clientName').value,
        projectNumber: document.getElementById('projectNumber').value,
        executiveSummary: document.getElementById('executiveSummary').value,
        totalInvestment: document.getElementById('totalInvestment').value,
      };
      const name = proposal.projectNumber || proposal.clientName || "Untitled";
      const { error } = await db.from("proposals")
        .upsert({ name, content: proposal })
        .eq("name", name);
      if (error) {
        alert("Error saving: " + error.message);
      } else {
        renderPreview(proposal);
        alert("Saved to Supabase ✅");
      }
    }

    async function loadProposals() {
      const { data, error } = await db.from("proposals").select("name, content, created_at").order("created_at", { ascending: false }).limit(10);
      if (error) return alert("Error loading: " + error.message);
      const list = document.getElementById("proposalList");
      list.innerHTML = "";
      data.forEach(p => {
        const btn = document.createElement("button");
        btn.textContent = `${p.name} (${new Date(p.created_at).toLocaleString()})`;
        btn.className = "block w-full text-left border p-2 hover:bg-slate-100";
        btn.onclick = () => {
          document.getElementById("clientName").value = p.content.clientName || "";
          document.getElementById("projectNumber").value = p.content.projectNumber || "";
          document.getElementById("executiveSummary").value = p.content.executiveSummary || "";
          document.getElementById("totalInvestment").value = p.content.totalInvestment || "";
          renderPreview(p.content);
          closeDialog();
        };
        list.appendChild(btn);
      });
      document.getElementById("loadDialog").classList.remove("hidden");
    }

    function closeDialog() {
      document.getElementById("loadDialog").classList.add("hidden");
    }

    function renderPreview(p) {
      document.getElementById('previewContent').innerHTML = `
        <div class="mb-4">
          <strong>Client:</strong> ${p.clientName || '-'}<br/>
          <strong>Project:</strong> ${p.projectNumber || '-'}
        </div>
        <p class="mb-4">${p.executiveSummary || ''}</p>
        <div class="text-lg font-medium text-slate-800">Investment: ${p.totalInvestment || '-'}</div>
      `;
    }

    function exportClient() {
      const p = {
        clientName: document.getElementById('clientName').value,
        projectNumber: document.getElementById('projectNumber').value,
        executiveSummary: document.getElementById('executiveSummary').value,
        totalInvestment: document.getElementById('totalInvestment').value,
      };
      const html = `
        <!DOCTYPE html>
        <html><head><meta charset="utf-8"/><title>Proposal - ${p.clientName}</title>
        <script src="https://cdn.tailwindcss.com"><\/script></head>
        <body class="bg-white">
          <div class="max-w-4xl mx-auto p-6">
            <h1 class="text-3xl font-light text-slate-800 mb-6">Proposal for ${p.clientName}</h1>
            <p class="mb-4 text-slate-700">${p.executiveSummary}</p>
            <div class="text-lg font-medium text-slate-800">Investment: ${p.totalInvestment}</div>
            <button onclick="window.print()" class="mt-8 bg-slate-800 text-white px-4 py-2">Download PDF</button>
          </div>
        </body></html>`;
      const blob = new Blob([html], {type:'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${p.projectNumber || "Proposal"}_${p.clientName.replace(/\s+/g,'_') || "Client"}.html`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>

